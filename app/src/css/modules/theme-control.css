/* ==========================================================================
   MODULE: Theme Control (Segmented)
   ========================================================================== */

/* Container wrapper to ensure proper spacing in menu */
.theme-control-wrapper {
    width: 100%;
    padding: 0.25rem 0.5rem;
    box-sizing: border-box;
    margin-bottom: 0;
    display: flex;
    /* Added for centering */
    justify-content: center;
    /* Center the control */
}

/* The main container for the segmented control */
.theme-segmented-control {
    position: relative;
    display: flex;
    align-items: center;
    background: var(--bg-secondary);
    /* Harmonisé avec le sélecteur de période */
    border-radius: var(--radius-pill);
    /* Forme globale pilule */
    padding: 4px;
    /* Harmonisé (était 3px) */
    width: fit-content;
    min-width: 90px;
    height: 36px;
    /* Ajusté pour le padding 4px */
    border: none;
    isolation: isolate;
    /* Create stacking context */
    gap: 0;
}

/* Individual segments (buttons) */
.theme-segment {
    flex: 1;
    position: relative;
    z-index: 2;
    /* Above the glider */
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    background: transparent;
    color: var(--text-secondary);
    /* Harmonisé avec Semestre 2 */
    font-size: 0.9rem;
    /* Slightly smaller icon */
    cursor: pointer;
    transition: color var(--transition-base);
    height: 100%;
    border-radius: var(--radius-pill);
    outline: none;
    /* Focus handled by :focus-visible */
    -webkit-tap-highlight-color: transparent;
}

/* Icon inside the segment */
.theme-segment i {
    pointer-events: none;
    /* Pass clicks to button */
}

/* Hover state for non-active segments */
.theme-segment:hover {
    color: var(--text-primary);
}

/* Active state (text color) */
.theme-segment.active {
    color: var(--text-primary);
}

/* The Glider (Sliding Background) */
.theme-glider {
    position: absolute;
    top: 4px;
    /* Match padding */
    bottom: 4px;
    /* Match padding */
    left: 4px;
    /* Match padding */
    width: calc((100% - 8px) / 3);
    /* 3 segments, minus padding (4px*2 = 8px) */
    background: var(--surface-color);
    border-radius: var(--radius-pill);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06);
    /* Harmonised shadow */
    z-index: 1;
    /* Behind text/icon */
    transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
    /* Harmonised spring timing */
    pointer-events: none;
}

/* Glider Positioning Logic */
/* We can use data attributes on the parent to drive the glider position 
   managed by JS, but simpler is to use classes or just explicit transform via JS.
   
   However, we can do it with pure CSS if we use :has() or similar, 
   but for broad compatibility and simplicity, let's use a class or attribute on the container.
*/

/* Default (Light) - Position 0 */
.theme-segmented-control[data-active="light"] .theme-glider {
    transform: translateX(0%);
}

/* System - Position 1 */
.theme-segmented-control[data-active="system"] .theme-glider {
    transform: translateX(100%);
}

/* Dark - Position 2 */
.theme-segmented-control[data-active="dark"] .theme-glider {
    transform: translateX(200%);
}

/* High Contrast Focus Rings */
.theme-segment:focus-visible {
    box-shadow: 0 0 0 2px var(--primary-color);
}

/* Dark Mode Adjustments */
[data-theme="dark"] .theme-segmented-control {
    background: rgba(0, 0, 0, 0.4);
    /* Darker track for depth */
    box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--border-color);
    /* Subtle border definition via token */
}

[data-theme="dark"] .theme-glider {
    background: rgba(255, 255, 255, 0.12);
    /* Harmonisé avec Semestre 2 */
    box-shadow: var(--shadow-sm);
    backdrop-filter: blur(4px);
    /* Glassmorphism effect */
}

[data-theme="dark"] .theme-segment {
    color: var(--text-secondary);
    /* Token unifié */
}

[data-theme="dark"] .theme-segment:hover {
    color: var(--text-primary);
}

[data-theme="dark"] .theme-segment.active {
    color: var(--text-primary);
    /* Bright white active state */
    text-shadow: 0 0 12px rgba(255, 255, 255, 0.25);
    /* Subtle glow harmonisé */
}