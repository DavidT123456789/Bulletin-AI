<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulletin AI | L'assistant de r√©daction pour enseignants</title>
    <meta name="description"
        content="Assistant intelligent pour enseignants. Importez vos notes, g√©n√©rez des appr√©ciations personnalis√©es par IA et exportez vos bulletins en quelques clics.">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- CSS -->
    <link rel="stylesheet" href="./src/css/landing.css">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="./assets/icon.svg" media="(prefers-color-scheme: light)">
    <link rel="icon" type="image/svg+xml" href="./assets/icon-dark-mode.svg" media="(prefers-color-scheme: dark)">
</head>

<body>

    <!-- Background Elements -->
    <div class="lp-bg-gradient">
        <div class="lp-bg-orb lp-bg-orb--primary"></div>
        <div class="lp-bg-orb lp-bg-orb--accent"></div>
        <div class="lp-bg-orb lp-bg-orb--secondary"></div>
    </div>

    <!-- Navigation -->
    <nav class="lp-nav" id="navbar">
        <div class="lp-container lp-nav__inner">
            <a href="#" class="lp-nav__brand">
                <img src="./assets/logo.png" alt="Logo" class="lp-nav__logo">
                Bulletin AI
                <span class="lp-nav__badge">
                    <i class="fas fa-flask"></i> v0.1.0 Beta Public
                </span>
            </a>

            <div class="lp-nav__links">
                <a href="#how-it-works" class="lp-nav__link">Flux de travail</a>
                <a href="#features" class="lp-nav__link">Fonctionnalit√©s</a>
                <a href="#specs" class="lp-nav__link">Sp√©cifications</a>
            </div>

            <div class="lp-nav__cta">


                <a href="./app.html" class="lp-btn lp-btn--primary lp-btn--sm">
                    Lancer l'App
                </a>
                <button class="lp-nav__toggle" aria-label="Menu" onclick="toggleMobileMenu()">
                    <span class="lp-nav__toggle-icon"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div class="lp-mobile-menu" id="mobileMenu">
        <div class="lp-mobile-menu__backdrop" onclick="toggleMobileMenu()"></div>
        <div class="lp-mobile-menu__panel">
            <nav class="lp-mobile-menu__links">
                <a href="#how-it-works" class="lp-mobile-menu__link" onclick="toggleMobileMenu()">Flux de travail</a>
                <a href="#features" class="lp-mobile-menu__link" onclick="toggleMobileMenu()">Fonctionnalit√©s</a>
                <a href="#specs" class="lp-mobile-menu__link" onclick="toggleMobileMenu()">Sp√©cifications</a>
            </nav>
            <div class="lp-mobile-menu__cta">
                <a href="./app.html" class="lp-btn lp-btn--primary">
                    <i class="fas fa-wand-magic-sparkles"></i> Lancer l'App
                </a>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <header class="lp-section lp-section--hero" id="hero">
        <div class="lp-container">
            <div class="lp-hero__content">
                <div class="lp-hero__text-column">
                    <!-- Badge moved to navbar -->

                    <h1 class="lp-hero__title">
                        <span class="lp-hero__title-gradient">Assistant Num√©rique</span> <br>
                        pour la r√©daction des bulletins scolaires.
                    </h1>

                    <p class="lp-hero__subtitle">
                        Une aide √† la r√©daction assist√©e par IA, con√ßue pour les enseignants.
                    </p>

                    <div class="lp-hero__actions">
                        <a href="./app.html" class="lp-btn lp-btn--primary lp-btn--lg">
                            <i class="fas fa-wand-magic-sparkles"></i> Lancer l'application
                        </a>
                    </div>

                    <div class="lp-hero__stats">
                        <div class="lp-hero__stat">
                            <div class="lp-hero__stat-icon"><i class="fas fa-code-branch"></i></div>
                            <span>Open Source</span>
                        </div>
                        <div class="lp-hero__stat">
                            <div class="lp-hero__stat-icon"><i class="fas fa-check"></i></div>
                            <span>Gratuit</span>
                        </div>
                        <div class="lp-hero__stat">
                            <div class="lp-hero__stat-icon"><i class="fas fa-user-shield"></i></div>
                            <span>Donn√©es anonymis√©es</span>
                        </div>
                        <div class="lp-hero__stat">
                            <div class="lp-hero__stat-icon"><i class="fas fa-bolt"></i></div>
                            <span>Sans installation</span>
                        </div>
                    </div>
                </div>

                <!-- Integrated Demo Mockup -->
                <div class="lp-hero__visual lp-reveal">
                    <div class="lp-hero__mockup">
                        <div class="lp-hero__mockup-header">
                            <div class="lp-hero__mockup-title">
                                <i class="fas fa-bolt"></i> Assistant de r√©daction
                            </div>
                            <div class="lp-hero__mockup-status" id="mockup-status-badge">
                                <i class="fas fa-spinner fa-spin lp-hero__status-spinner"></i>
                                <i class="fas fa-check lp-hero__status-check"></i>
                            </div>
                        </div>
                        <div class="lp-hero__mockup-content">
                            <!-- Left: Input/Problem -->
                            <div class="lp-hero__mockup-before">
                                <div class="lp-hero__mockup-label">
                                    <i class="fas fa-file-excel"></i> Donn√©es brutes
                                </div>
                                <div class="lp-hero__mockup-text">
                                    <strong>Math√©o D.</strong><br>
                                    Moyenne : 8.5/20<br>
                                    <em>"Bavardages incessants, passif en cours, r√©sultats en baisse..."</em>
                                </div>
                            </div>

                            <!-- Middle: Analysis -->
                            <div class="lp-hero__mockup-middle" id="mockup-analysis-card">
                                <div class="lp-hero__mockup-label">
                                    <i class="fas fa-chart-pie"></i> Analyse IA
                                </div>
                                <div class="lp-hero__mockup-text" id="mockup-analysis-content">
                                    <!-- Content injected by JS -->
                                </div>
                            </div>

                            <!-- Right: Output/Solution -->
                            <div class="lp-hero__mockup-after" id="mockup-ai-card">
                                <div class="lp-hero__mockup-label">
                                    <i class="fas fa-robot"></i> Appr√©ciation
                                </div>
                                <div class="lp-hero__mockup-text-container">
                                    <div class="lp-hero__mockup-text-ghost">
                                        Les r√©sultats de Math√©o sont fragiles ce trimestre. Un manque d'investissement
                                        et des bavardages perturbent sa progression. Il est imp√©ratif qu'il se recentre
                                        et adopte une attitude plus studieuse pour redresser la barre.
                                    </div>
                                    <div class="lp-hero__mockup-text lp-hero__mockup-text-absolute" id="mockup-ai-text">
                                        <!-- Text will be injected by JS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>



    <!-- How it Works -->
    <section class="lp-section" id="how-it-works">
        <div class="lp-container lp-steps">
            <div class="lp-steps__header lp-reveal">
                <h2 class="lp-steps__title">Flux de travail</h2>
                <p class="lp-steps__subtitle">Import des notes, analyse du contexte et g√©n√©ration d'appr√©ciations par
                    IA.
                </p>
            </div>

            <div class="lp-steps__grid">
                <!-- Step 1 -->
                <div class="lp-step lp-reveal lp-reveal--delay-1">
                    <div class="lp-step__number">1</div>
                    <div class="lp-step__icon">
                        <i class="fas fa-file-import"></i>
                    </div>
                    <h3 class="lp-step__title">Importez vos donn√©es</h3>
                    <div class="lp-step__badge"><i class="fas fa-bolt"></i> 30 secondes</div>
                    <p class="lp-step__text">
                        Un simple copier-coller depuis n'importe quel tableur. Les colonnes sont d√©tect√©es
                        automatiquement.
                    </p>
                </div>

                <!-- Step 2 -->
                <div class="lp-step lp-reveal lp-reveal--delay-2">
                    <div class="lp-step__number">2</div>
                    <div class="lp-step__icon">
                        <i class="fas fa-wand-magic-sparkles"></i>
                    </div>
                    <h3 class="lp-step__title">G√©n√©rez en un clic</h3>
                    <div class="lp-step__badge"><i class="fas fa-robot"></i> Automatique</div>
                    <p class="lp-step__text">
                        L'IA analyse et g√©n√®re points forts, axes d'am√©lioration et appr√©ciation pour chaque √©l√®ve.
                    </p>
                </div>

                <!-- Step 3 -->
                <div class="lp-step lp-reveal lp-reveal--delay-3">
                    <div class="lp-step__number">3</div>
                    <div class="lp-step__icon">
                        <i class="fas fa-check-double"></i>
                    </div>
                    <h3 class="lp-step__title">Supervisez et exportez</h3>
                    <div class="lp-step__badge"><i class="fas fa-check-circle"></i> Export direct</div>
                    <p class="lp-step__text">
                        Relisez, ajustez si besoin, puis copiez directement dans votre logiciel scolaire.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Bento Grid Features -->
    <section class="lp-section" id="features">
        <div class="lp-container">
            <div class="lp-features__header lp-reveal">
                <h2 class="lp-features__title">Fonctionnalit√©s</h2>
                <p class="lp-features__subtitle">Une suite d'outils con√ßue pour la productivit√© et la confidentialit√©.
                </p>
            </div>

            <!-- Opal-Style Fan Deck Carousel -->
            <div class="lp-features-carousel-wrapper lp-reveal">
                <div class="lp-features-carousel" id="featuresCarousel">
                    <!-- Card 1: Formats - Green -->
                    <div class="lp-feature-card" data-color="green">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-file-csv"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Formats Universels</h3>
                                <p class="lp-feature-card__text">
                                    Compatible CSV, Excel, et copier-coller direct depuis les principaux logiciels
                                    scolaires.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 2: Personnalisation - Blue -->
                    <div class="lp-feature-card" data-color="blue">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-sliders-h"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Personnalisation</h3>
                                <p class="lp-feature-card__text">
                                    D√©finissez des r√®gles pr√©cises : vouvoiement, tutoiement, structure des phrases.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 3: Multi-Mod√®les IA - Amber -->
                    <div class="lp-feature-card" data-color="amber">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-brain"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Multi-Mod√®les IA</h3>
                                <p class="lp-feature-card__text">
                                    Mistral AI üá´üá∑ gratuit (1Md tokens/mois), Google Gemini, ou Ollama en local.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 4: Anonymisation - Rose -->
                    <div class="lp-feature-card" data-color="rose">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-user-shield"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Anonymisation Auto</h3>
                                <p class="lp-feature-card__text">
                                    Les noms sont anonymis√©s avant envoi. Donn√©es stock√©es localement.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 5: Journal - Purple -->
                    <div class="lp-feature-card" data-color="purple">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-book-open"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Journal de Bord</h3>
                                <p class="lp-feature-card__text">
                                    Notes et observations au fil du trimestre pour enrichir l'appr√©ciation.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 6: Cloud Sync - Cyan -->
                    <div class="lp-feature-card" data-color="cyan">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Sync Cloud Optionnelle</h3>
                                <p class="lp-feature-card__text">
                                    Sauvegarde chiffr√©e sur Google Drive possible (d√©sactiv√©e par d√©faut).
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Card 7: Photos - Orange -->
                    <div class="lp-feature-card" data-color="orange">
                        <div class="lp-feature-card__inner">
                            <div class="lp-feature-card__illustration">
                                <i class="fas fa-camera"></i>
                            </div>
                            <div class="lp-feature-card__content">
                                <h3 class="lp-feature-card__title">Photos √âl√®ves</h3>
                                <p class="lp-feature-card__text">
                                    Importez le trombinoscope pour visualiser vos √©l√®ves facilement.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Specifications / FAQ -->
    <section class="lp-section" id="specs">
        <div class="lp-container">
            <div class="lp-faq__header lp-reveal">
                <h2 class="lp-faq__title" style="white-space: nowrap;">Sp√©cifications & Confidentialit√©</h2>
                <p class="lp-faq__subtitle">D√©tails techniques et fonctionnement de l'application.</p>
            </div>

            <div class="lp-faq__list">
                <!-- Q1 -->
                <div class="lp-faq__item lp-reveal">
                    <button class="lp-faq__question" onclick="toggleFaq(this)">
                        Architecture Local-First & Confidentialit√©
                        <span class="lp-faq__icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="lp-faq__answer">
                        <div class="lp-faq__answer-content">
                            Les donn√©es sensibles (identit√©s des √©l√®ves, notes brutes) sont stock√©es exclusivement dans
                            le <strong>LocalStorage</strong> du navigateur.
                            L'application applique une <strong>anonymisation stricte</strong> √† la vol√©e avant tout
                            envoi de contexte (pr√©nom, bulletins pr√©c√©dents) vers les API d'inf√©rence.
                        </div>
                    </div>
                </div>

                <!-- Q2 -->
                <div class="lp-faq__item lp-reveal">
                    <button class="lp-faq__question" onclick="toggleFaq(this)">
                        Mod√®les IA & Haute Disponibilit√©
                        <span class="lp-faq__icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="lp-faq__answer">
                        <div class="lp-faq__answer-content">
                            <strong>Support Multi-Provider :</strong> Compatible nativement avec Mistral AI, Google
                            Gemini et OpenRouter.<br>
                            <strong>Support Local (Air-Gapped) :</strong> Int√©gration compl√®te avec Ollama pour une
                            ex√©cution 100% hors ligne.<br>
                            <strong>Relais Automatique :</strong> Syst√®me de basculement intelligent (fallback) assurant
                            la continuit√© du service en cas d'indisponibilit√© d'une API.
                        </div>
                    </div>
                </div>

                <!-- Q3 (NEW) -->
                <div class="lp-faq__item lp-reveal">
                    <button class="lp-faq__question" onclick="toggleFaq(this)">
                        Ing√©nierie des Prompts (System Prompts)
                        <span class="lp-faq__icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="lp-faq__answer">
                        <div class="lp-faq__answer-content">
                            L'application utilise des <strong>System Prompts calibr√©s</strong> pour garantir un ton
                            professionnel et p√©dagogique.<br>
                            Les commandes (Concis, D√©taill√©, Encourageant) modifient dynamiquement les param√®tres de
                            g√©n√©ration (temp√©rature, p√©nalit√© de fr√©quence) pour produire des r√©sultats d√©terministes et
                            adapt√©s au contexte scolaire.
                        </div>
                    </div>
                </div>

                <!-- Q4 -->
                <div class="lp-faq__item lp-reveal">
                    <button class="lp-faq__question" onclick="toggleFaq(this)">
                        Standards de Donn√©es & Interop√©rabilit√©
                        <span class="lp-faq__icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="lp-faq__answer">
                        <div class="lp-faq__answer-content">
                            <strong>Import Agnostique :</strong> Algorithme de d√©tection automatique de colonnes
                            compatible avec tout tableur (Excel, CSV, Pronote).<br>
                            <strong>Export :</strong> Les donn√©es sont exportables en format JSON ouvert pour la
                            sauvegarde, ou en texte brut format√© pour l'int√©gration dans les logiciels de vie scolaire.
                        </div>
                    </div>
                </div>

                <!-- Q5 -->
                <div class="lp-faq__item lp-reveal">
                    <button class="lp-faq__question" onclick="toggleFaq(this)">
                        Licence & Contribution
                        <span class="lp-faq__icon"><i class="fas fa-chevron-down"></i></span>
                    </button>
                    <div class="lp-faq__answer">
                        <div class="lp-faq__answer-content">
                            Code source distribu√© sous licence <strong>CC BY-NC-SA 4.0</strong>.<br>
                            Le projet encourage la transparence totale : le code est auditable sur GitHub pour v√©rifier
                            l'absence de t√©l√©m√©trie cach√©e ou de traitements de donn√©es tiers non d√©clar√©s.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Final CTA -->
    <section class="lp-section lp-cta">
        <div class="lp-container lp-reveal">
            <!-- Commercial CTA removed by user request -->
            <!-- <div class="lp-cta__content">...</div> -->

            <!-- Glass Project Open Source Section (Merged) -->
            <div class="lp-cta__contribute-glass">
                <div class="lp-contribute__content">
                    <div class="lp-contribute__icon">
                        <i class="fas fa-code-branch"></i>
                    </div>
                    <div class="lp-contribute__text">
                        <h3 class="lp-contribute__title">Projet Open Source</h3>
                        <p>Contribuez au code ou soutenez le projet.</p>
                    </div>
                    <div class="lp-contribute__actions">
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLScMfb2MVugiZpgq-ITF5RxG8dKQAd8zKvHuTHHIfhN18Ucmag/viewform"
                            target="_blank" class="lp-btn lp-btn--secondary lp-btn--sm">
                            <i class="fas fa-comment-dots"></i> Avis
                        </a>
                        <a href="https://github.com/davidt123456789/Bulletin-AI" target="_blank"
                            class="lp-btn lp-btn--secondary lp-btn--sm">
                            <i class="fab fa-github"></i> GitHub
                        </a>
                        <a href="https://ko-fi.com/profassistant" target="_blank"
                            class="lp-btn lp-btn--accent lp-btn--sm">
                            <i class="fas fa-heart"></i> Soutenir
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="lp-footer lp-footer--wide">
        <div class="lp-container">
            <div class="lp-footer__wide">
                <div class="lp-footer__brand-inline">
                    <img src="./assets/logo.png" alt="Logo" class="lp-footer__logo-sm">
                    <span>Bulletin AI</span>
                </div>
                <div class="lp-footer__links-inline">
                    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.fr" target="_blank">CC BY-NC-SA</a>
                </div>
                <div class="lp-footer__copyright">
                    ¬© 2026 ‚Äî D√©velopp√© par un prof, pour les profs üéì
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Navbar Scroll Effect
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('is-scrolled');
            } else {
                navbar.classList.remove('is-scrolled');
            }
        });

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const toggle = document.querySelector('.lp-nav__toggle');
            const mobileMenu = document.getElementById('mobileMenu');

            if (mobileMenu && toggle) {
                const isOpen = mobileMenu.classList.contains('is-open');

                if (isOpen) {
                    mobileMenu.classList.remove('is-open');
                    toggle.classList.remove('is-open');
                    document.body.style.overflow = '';
                } else {
                    mobileMenu.classList.add('is-open');
                    toggle.classList.add('is-open');
                    document.body.style.overflow = 'hidden';
                }
            }
        }

        // Close mobile menu on resize to desktop
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                const mobileMenu = document.getElementById('mobileMenu');
                const toggle = document.querySelector('.lp-nav__toggle');
                if (mobileMenu && mobileMenu.classList.contains('is-open')) {
                    mobileMenu.classList.remove('is-open');
                    toggle?.classList.remove('is-open');
                    document.body.style.overflow = '';
                }
            }
        });

        // FAQ Toggle
        function toggleFaq(button) {
            const item = button.parentElement;
            const isOpen = item.classList.contains('is-open');

            // Close all others
            document.querySelectorAll('.lp-faq__item').forEach(i => {
                i.classList.remove('is-open');
            });

            // Toggle current
            if (!isOpen) {
                item.classList.add('is-open');
            }
        }

        // Scroll Reveal Animation
        const observerOptions = {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px"
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target); // Only animate once
                }
            });
        }, observerOptions);

        document.querySelectorAll('.lp-reveal').forEach(el => {
            observer.observe(el);
        });

        // ============================================
        // PAGE TRANSITION (iOS 2025 Style)
        // ============================================

        /**
         * Creates an elegant zoom-out + fade transition when navigating to the app
         * Uses View Transitions API where available, with CSS fallback
         */
        function initPageTransition() {
            // Create transition overlay element
            const overlay = document.createElement('div');
            overlay.className = 'lp-transition-overlay';
            document.body.appendChild(overlay);

            // Find all links to app.html
            const appLinks = document.querySelectorAll('a[href="./app.html"], a[href="app.html"]');

            appLinks.forEach(link => {
                link.addEventListener('click', async (e) => {
                    e.preventDefault();
                    const targetUrl = link.href;

                    // Add transitioning state to clicked button
                    link.classList.add('is-transitioning');

                    // Check if View Transitions API is supported
                    if (document.startViewTransition) {
                        // Modern browsers: Use native View Transitions
                        document.startViewTransition(() => {
                            window.location.href = targetUrl;
                        });
                    } else {
                        // Fallback: CSS-based transition
                        // 1. Activate overlay (subtle white flash)
                        overlay.classList.add('is-active');

                        // 2. Trigger exit animation on body
                        document.body.classList.add('is-transitioning-out');

                        // 3. Navigate after animation completes
                        // Mark navigation timestamp for app to detect
                        sessionStorage.setItem('landingTransition', Date.now().toString());

                        setTimeout(() => {
                            window.location.href = targetUrl;
                        }, 500); // Match animation duration
                    }
                });
            });
        }

        // Initialize transition system
        initPageTransition();

        // ============================================
        // FEATURES CAROUSEL (Opal Style - Step by Step)
        // ============================================

        /**
         * Arc carousel with step-by-step navigation
         * Cards rotate into position with center card highlighted
         */
        /**
         * Arc carousel with step-by-step navigation
         * Cards rotate into position with center card highlighted
         */
        function initFeaturesCarousel() {
            const carousel = document.getElementById('featuresCarousel');
            if (!carousel) return;

            const cards = carousel.querySelectorAll('.lp-feature-card');
            const cardCount = cards.length;
            let currentCenter = 3; // Start with middle card (index 3 for 7 cards)
            let autoPlayInterval = null;
            let isPaused = false;
            let isAnimating = false;
            const AUTO_ADVANCE_DELAY = 3500; // 3.5 seconds

            // Position names for 5 visible slots
            const positions = ['far-left', 'left', 'center', 'right', 'far-right'];

            /**
             * Update card positions based on current center index
             * Simple rule: any card crossing from left side to right side (or vice versa) is a wrap
             */
            function updatePositions() {
                // Helper to determine which side a position is on
                const getSide = (pos) => {
                    if (!pos) return null;
                    if (pos.includes('left')) return 'left';
                    if (pos.includes('right')) return 'right';
                    return 'center';
                };

                cards.forEach((card, index) => {
                    const prevPos = card.getAttribute('data-pos');
                    const prevSide = getSide(prevPos);

                    // Calculate relative position from center
                    let relativePos = index - currentCenter;

                    // Handle wrapping for infinite loop
                    if (relativePos > Math.floor(cardCount / 2)) {
                        relativePos -= cardCount;
                    } else if (relativePos < -Math.floor(cardCount / 2)) {
                        relativePos += cardCount;
                    }

                    // Map relative position to actual position name
                    let posName;
                    if (relativePos === 0) {
                        posName = 'center';
                    } else if (relativePos === -1) {
                        posName = 'left';
                    } else if (relativePos === 1) {
                        posName = 'right';
                    } else if (relativePos === -2) {
                        posName = 'far-left';
                    } else if (relativePos === 2) {
                        posName = 'far-right';
                    } else if (relativePos < -2) {
                        posName = 'hidden-left';
                    } else {
                        posName = 'hidden-right';
                    }

                    const newSide = getSide(posName);

                    // WRAP: card crosses from left to right or right to left (excluding center)
                    const isWrap = prevSide && newSide &&
                        prevSide !== 'center' && newSide !== 'center' &&
                        prevSide !== newSide;

                    if (isWrap) {
                        // Teleport: instant move to hidden position on destination side
                        const hiddenPos = newSide === 'right' ? 'hidden-right' : 'hidden-left';

                        card.style.transition = 'none';
                        card.setAttribute('data-pos', hiddenPos);
                        card.offsetHeight; // Force reflow
                        card.style.transition = '';

                        // Then animate to final position
                        requestAnimationFrame(() => {
                            card.setAttribute('data-pos', posName);
                        });
                    } else {
                        card.setAttribute('data-pos', posName);
                    }
                });
            }

            /**
             * Advance to next card
             */
            function nextCard() {
                currentCenter = (currentCenter + 1) % cardCount;
                updatePositions();
            }

            /**
             * Go to previous card
             */
            function prevCard() {
                currentCenter = (currentCenter - 1 + cardCount) % cardCount;
                updatePositions();
            }

            /**
             * Move multiple steps sequentially
             * @param {number} steps - Number of steps (positive = next, negative = prev)
             */
            function moveSteps(steps) {
                if (steps === 0 || isAnimating) return;

                isAnimating = true;
                const direction = steps > 0 ? 1 : -1;
                let remaining = Math.abs(steps);

                // Determine shortest path (wrap around if needed)
                if (remaining > cardCount / 2) {
                    remaining = cardCount - remaining;
                    // Invert direction if we found a shorter path wrapping around
                    // logic: steps was e.g. 6 (go right), wrap is 1 (go left)
                    // But effectively we just use next/prev logic
                }

                // For simplicity in this fan, we just execute sequential moves
                // If the user clicked something 2 steps away, we do 2 steps.

                function step() {
                    if (remaining <= 0) {
                        isAnimating = false;
                        return;
                    }

                    if (direction > 0) nextCard();
                    else prevCard();

                    remaining--;

                    if (remaining > 0) {
                        setTimeout(step, 150); // fast delay between steps
                    } else {
                        isAnimating = false;
                    }
                }

                step();
            }

            /**
             * Start auto-advance timer
             */
            function startAutoPlay() {
                if (autoPlayInterval) clearInterval(autoPlayInterval);
                autoPlayInterval = setInterval(() => {
                    if (!isPaused && !isAnimating && !document.hidden) {
                        nextCard();
                    }
                }, AUTO_ADVANCE_DELAY);
            }

            /**
             * Pause/resume on hover
             */
            carousel.addEventListener('mouseenter', () => {
                isPaused = true;
            });

            carousel.addEventListener('mouseleave', () => {
                isPaused = false;
            });

            /**
             * Handle Visibility Change (Tab Switch Bug)
             */
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    // Pause definitely
                    if (autoPlayInterval) clearInterval(autoPlayInterval);
                } else {
                    // Resume checking
                    startAutoPlay();
                }
            });

            /**
             * Click on card to bring it to center
             */
            cards.forEach((card, index) => {
                card.addEventListener('click', () => {
                    if (isAnimating) return;

                    // Reset autoplay timer manually
                    startAutoPlay();

                    // Calculate shortest distance
                    let diff = index - currentCenter;

                    // Normalize diff to -cardCount/2 to cardCount/2
                    if (diff > cardCount / 2) diff -= cardCount;
                    if (diff < -cardCount / 2) diff += cardCount;

                    if (diff !== 0) {
                        moveSteps(diff);
                    }
                });
            });

            // Initialize positions
            updatePositions();

            // Start autoplay
            startAutoPlay();
        }

        // Initialize features carousel
        initFeaturesCarousel();



        // ============================================
        // HERO MOCKUP TYPING ANIMATION
        // ============================================
        function initMockupAnimation() {
            const aiTextElement = document.getElementById('mockup-ai-text');
            const aiCard = document.getElementById('mockup-ai-card');
            const analysisCard = document.getElementById('mockup-analysis-card');
            const analysisContent = document.getElementById('mockup-analysis-content');
            const statusBadge = document.getElementById('mockup-status-badge');

            if (!aiTextElement || !aiCard) return;

            const fullText = "Les r√©sultats de Math√©o sont fragiles ce trimestre. Un manque d'investissement et des bavardages perturbent sa progression. Il est imp√©ratif qu'il se recentre et adopte une attitude plus studieuse pour redresser la barre.";

            // Define analysis HTML blocks
            const blockPointsForts = `
                <div style="margin-bottom: 12px; opacity: 0; transform: translateY(10px); transition: all 0.5s ease" id="anim-pf">
                    <div style="color: #65a30d; font-weight: 600; font-size: 0.85rem; margin-bottom: 4px;">
                        <i class="fas fa-check-circle"></i> Points forts
                    </div>
                    <div style="font-size: 0.85rem;">Curiosit√© intellectuelle, Participation orale</div>
                </div>`;

            const blockToImprove = `
                <div style="opacity: 0; transform: translateY(10px); transition: all 0.5s ease" id="anim-ti">
                    <div style="color: #c2785c; font-weight: 600; font-size: 0.85rem; margin-bottom: 4px;">
                        <i class="fas fa-exclamation-circle"></i> √Ä am√©liorer
                    </div>
                    <div style="font-size: 0.85rem;">Concentration, Bavardages fr√©quents</div>
                </div>`;

            // Split text into word chunks for natural typing
            const words = fullText.split(' ');
            let currentWordIndex = 0;

            function typeWords() {
                if (currentWordIndex < words.length) {
                    // Create word span
                    const span = document.createElement('span');
                    span.textContent = words[currentWordIndex] + ' ';
                    span.style.opacity = '0';
                    span.style.filter = 'blur(4px)';
                    span.style.transition = 'all 0.4s ease';

                    aiTextElement.appendChild(span);

                    // Trigger reflow
                    span.offsetHeight;

                    // Animate in
                    span.style.opacity = '1';
                    span.style.filter = 'blur(0)';

                    currentWordIndex++;

                    // Random typing speed
                    const delay = Math.random() * 50 + 30;
                    setTimeout(typeWords, delay);
                } else {
                    // Done typing - morph badge to "done" state
                    aiCard.classList.remove('is-generating');
                    if (analysisCard) analysisCard.classList.remove('is-generating');
                    if (statusBadge) statusBadge.classList.add('is-done');
                    setTimeout(resetAnimation, 5000); // Wait 5s before restart
                }
            }

            function resetAnimation() {
                // Clear contents
                aiTextElement.innerHTML = '';
                if (analysisContent) analysisContent.innerHTML = ''; // Clear analysis

                currentWordIndex = 0;

                // Reset badge to "generating" state (spinner)
                if (statusBadge) statusBadge.classList.remove('is-done');

                // Start "Thinking" phase (border animation)
                aiCard.classList.add('is-generating');
                if (analysisCard) analysisCard.classList.add('is-generating');

                // Simulate processing time then start generation
                setTimeout(() => {
                    // 1. Start typing appreciation
                    typeWords();

                    // 2. Inject and Animate Analysis (staggered)
                    if (analysisContent) {
                        analysisContent.innerHTML = blockPointsForts + blockToImprove;

                        // Animate Points Forts immediately
                        setTimeout(() => {
                            const pf = document.getElementById('anim-pf');
                            if (pf) { pf.style.opacity = '1'; pf.style.transform = 'translateY(0)'; }
                        }, 100);

                        // Animate Improve after 1.2s
                        setTimeout(() => {
                            const ti = document.getElementById('anim-ti');
                            if (ti) { ti.style.opacity = '1'; ti.style.transform = 'translateY(0)'; }
                        }, 1200);
                    }
                }, 800);
            }

            // Start initial animation after a small delay
            setTimeout(resetAnimation, 1000);
        }

        initMockupAnimation();

        // ============================================
        // SCROLLSPY (Dynamic Header)
        // ============================================
        function initScrollSpy() {
            // Include the header (hero) in the observed sections
            const sections = document.querySelectorAll('section[id], header[id]');
            const navLinks = document.querySelectorAll('.lp-nav__links a');

            // Options to trigger when section is in the middle of viewport
            const observerOptions = {
                rootMargin: '-20% 0px -60% 0px',
                threshold: 0
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // Clean all active classes
                        navLinks.forEach(link => link.classList.remove('is-active'));

                        const id = entry.target.getAttribute('id');

                        // If we are in the Hero section, keep all links inactive
                        if (id === 'hero') return;

                        // Add active class to corresponding link
                        const activeLink = document.querySelector(`.lp-nav__links a[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('is-active');
                        }
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });
        }

        initScrollSpy();

        // ============================================
        // STEP CARDS SEQUENTIAL ACTIVATION
        // Badge fills organically, then moves to next step
        // ============================================
        function initStepActivation() {
            const steps = document.querySelectorAll('.lp-step');
            if (steps.length === 0) return;

            // Duration synced EXACTLY with CSS liquid fill animation (4.5s)
            // Transition happens the moment the fill completes = visual timer
            const STEP_DURATION = 4500;
            let currentStep = 0;
            let isAnimating = false;

            function activateStep() {
                // Mark previous step as "was-active" for smooth reset
                steps.forEach(s => {
                    if (s.classList.contains('is-active')) {
                        s.classList.add('was-active');
                    }
                    s.classList.remove('is-active');
                });

                // Activate current step
                steps[currentStep].classList.remove('was-active');
                steps[currentStep].classList.add('is-active');

                // Next step
                currentStep = (currentStep + 1) % steps.length;
            }

            // Only start animation when section is visible
            const howItWorksSection = document.getElementById('how-it-works');
            if (!howItWorksSection) {
                // Fallback: start immediately
                activateStep();
                setInterval(activateStep, STEP_DURATION);
                return;
            }

            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && !isAnimating) {
                        isAnimating = true;
                        // Reset to first step when section comes into view
                        currentStep = 0;
                        activateStep();
                        setInterval(activateStep, STEP_DURATION);
                    }
                });
            }, { threshold: 0.3 });

            sectionObserver.observe(howItWorksSection);
        }

        initStepActivation();
    </script>
</body>

</html>